웹 인터페이스를 제공하는 어댑터(UI 나 호출되는 HTTP API 등)를 구현하는 방법을 알아본다.

## 5.1 의존성 역전

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/65aa54fa-edf8-4838-959c-4098c5d14793/Untitled.png)

주도하는 웹 어댑터는 애플리케이션 코어를 호출하는 식으로 제어 흐름이 흐른다. 이 때 포트 인터페이스는 애플리케이션 코어가 외부 세계와 통신할 수 있는 곳에 대한 명세 역할을 한다.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2c15f9fd-781a-474e-9f40-90b059b72094/Untitled.png)

웹소켓을 통해 실시간으로 브라우저에 보내는 경우 웹 어댑터가 구현한 포트 인터페이스를 애플리케이션 서비스에서 호출한다. 따라서 이제 웹 어댑터는 인커밍이면서 아웃고잉 어댑터가 되었다.

## 5.2 웹 어댑터의 책임

1. HTTP 요청을 객체로 매핑 : HTTP 요청을 수신해서 파라미터를 객체로 역직렬화
2. 권한 검사 : 인증과 권한 부여 후 실패할 경우 에러 반환
3. 입력 유효성 검증 : 웹 어댑터의 입력 모델의 유효성 검증
4. 입력을 유스케이스의 입력 모델로 매핑 : 유스케이스의 입력 모델로 변환가능한지 검증 후 매핑
5. 유스케이스 호출
6. 유스케이스의 출력을 HTTP 로 매핑
7. HTTP 응답을 반환

## 5.3 컨트롤러 나누기

컨트롤러는 다른 컨트롤러와 가능한 한 적게 공유하는 웹 어댑터 조각을 구현해야 한다. 너무 적은 것 보다는 많은게 낫다. 클래스마다 코드는 적은게 좋다.

AccountController 하나가 계좌와 관련된 모든 요청을 받는 것이 아니다. 단일 컨트롤러에 모두 구현하면 모델 클래스를 공유하고 어느 컨트롤러에선 쓰이지 않을 필드까지 가지고 있어야할 수도 있다.

따라서 용도가 분명한 단일 책임 컨트롤러로 나눈다. 예를 들어서 SendMoneyController와 같이 목적이 분명한 컨트롤러를 만들고 SendMoneyCommand와 같이 목적이 분명한 입력 모델을 사용한다.

## 5.4 유지보수 가능한 소프트웨어를 만드는데 어떻게 도움이 될까?

웹 어댑터를 구현할 때에는 유스케이스 호출, 결과 반환 외에 어떠한 도메인 로직도 수행하지 않는다.

애플리케이션 계층은 HTTP 와 관련된 작업을 하지 않는다.